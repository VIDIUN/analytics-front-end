<div class="vReport vContent vOverrideFAIcons">
  <div class="vReportHeader">
    <span class="vTitle">{{'app.bandwidth.publisherStorage' | translate}}</span>
    <app-export-csv [headers]="_csvExportHeaders" [totalCount]="_totalCount" [reportInputFilter]="filter" [reportType]="reportType"
                    [dimension]="_selectedMetrics" [reportText]="'app.common.noMsg' | translate" [reportTitle]="'app.bandwidth.title' | translate"></app-export-csv>
    <app-date-filter #dateFilter [dateRange]="_dateRange" [dateRangeType]="_dateRangeType" (filterChange)="_onDateFilterChange($event)"></app-date-filter>
  </div>

  <div class="vFilters">
    <span class="vTitle">{{'app.bandwidth.highlights' | translate}}</span>
  </div>

  <v-area-blocker [message]="_blockerMessage" [showLoader]="_isBusy">

    <div class="vReportContent">
      <app-report-tabs [tabs]="_tabsData" [compareMode]="isCompareMode" (tabChange)="_onTabChange($event)"></app-report-tabs>
      <div class="vDimensions">
        <app-time-units [dateFilter]="dateFilter"></app-time-units>
      </div>
      <div class="vChart">
        <div echarts class="vChart" [options]="_barChartData[_selectedMetrics]" *ngIf="_chartType==='bar'"></div>
        <div echarts class="vChart" [options]="_lineChartData[_selectedMetrics]" *ngIf="_chartType==='line'"></div>
      </div>

      <div class="vTable">
        <div class="vToggle">
          <i [class.vIcondropdown_arrow_bottom]="!_showTable" [class.vIcondropdown_arrow_top]="_showTable"></i>
          <a (click)="toggleTable()">{{(_showTable ? 'app.common.hideDetails' : 'app.common.viewDetails') | translate}}</a>
        </div>
        <div class="vTableContainer" [class.vOpen]="_showTable" [class.vClose]="!_showTable">
          <p-table [value]="_tableData" (sortFunction)="_onSortChanged($event)" [customSort]="true" sortField="month_id" [sortOrder]="-1" [defaultSortOrder]="-1">
            <ng-template pTemplate="header">
              <tr>
                <th *ngFor="let col of _columns" [pSortableColumn]="isCompareMode ? null : col">
                  <div class="vColumnHeader">
                    <span [vTooltip]="'app.bandwidth.publisher_table.' + col | translate" [showOnEllipsis]="true">
                      {{'app.bandwidth.publisher_table.' + col | translate}}
                    </span>
                    <p-sortIcon [field]="col" *ngIf="!isCompareMode"></p-sortIcon>
                  </div>
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data>
              <tr>
                <td *ngFor="let col of _columns; let i = index" [class.vHighlight]="i===0">
                  <span *ngIf="isCompareMode && data[col]?.value !== undefined"
                        class="vTrend"
                        [vTooltip]="data[col].tooltip" [escape]="false" [maxWidth]="500">
                    <app-trend-value [value]="data[col].value"
                                     [units]="data[col].units"
                                     [trend]="data[col].trend"></app-trend-value>
                  </span>
                  <span *ngIf="!isCompareMode || data[col]?.value === undefined">{{data[col]}}</span>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <div class="emptymessage">
                <div class="vEmptyMessage" *ngIf="!_isBusy">{{'app.common.noResults' | translate}}</div>
                <div class="vEmptyMessage" *ngIf="_isBusy">&nbsp;</div>
              </div>
            </ng-template>
          </p-table>
          <p-paginator [rows]="pager.pageSize" (onPageChange)="_onPaginationChanged($event)" [first]="(pager.pageIndex -1) * pager.pageSize" [totalRecords]="_totalCount"></p-paginator>
        </div>
      </div>

      <div class="vSeparator"></div>
      <span class="vAccumulativeTitle">{{'app.bandwidth.accumulative' | translate}}</span>
      <div class="vAccumulative">
        <div class="vItem" *ngFor="let item of _accumulativeStorage">
          <span class="vLabel">{{item.title}}</span>
          <div class="vValueContainer">
            <span *ngIf="isCompareMode" class="vTrend" [vTooltip]="item.tooltip" [maxWidth]="500" [escape]="false">
              <app-trend-value valueStyleClass="vValue"
                               [value]="item.value"
                               [trend]="item.trend"></app-trend-value>
              <span class="vUnits">{{item.units}}</span>
            </span>
            <ng-container *ngIf="!isCompareMode">
              <span class="vValue">{{item.value}}</span>
              <span class="vUnits">{{item.units}}</span>
            </ng-container>
          </div>
        </div>
      </div>

    </div>

  </v-area-blocker>

</div>

